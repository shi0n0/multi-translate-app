{% extends "base.html" %}
{% block tab-title %}
AI翻訳
{% endblock %}
{% block content%}
<form method="post" action="{% url 'translation' %}" class="flex flex-col content-center justify-center text-black p-5 md:w-full md:flex-row">

    <div class="md:w-full">
    {% csrf_token %}
    <label for="input_text" class="text-white">翻訳するテキスト</label><br>
    <textarea class="rounded-lg w-full h-50 p-3" id="input_text" name="input_text" rows="10" placeholder="ここに翻訳するテキストを入力してください"></textarea><br><br>
    </div>
    

    <div class="text-white flex flex-col justify-center m-1">
        <button type="submit" class="w-8 text-3xl" name="transBtn">→</button>
        <button type="submit" class="w-8 text-3xl" name="reverseBtn">←</button>
    </div>
    

    <div class="md:w-full">
        {% csrf_token %}
        <label for="input_text" class="text-white">翻訳されたテキスト</label>
        <button class="text-white" onclick="copyToClipboard(event)">コピー</button>
        <br>
        <textarea class="rounded-lg w-full h-50 p-3" id="translated_text" name="translated_text" rows="10" placeholder="ここに翻訳後のテキストが表示されます。&#10;このテキストを日本語に再翻訳したい場合は←ボタンを押してください" readonly></textarea>
        <br><br>
    </div>
      
</form>
{% endblock %}
{% block subcontent %}
<br>
<h3>【使用方法】</h3>
<p>1. 左のテキストエリアに翻訳した文章を入力します
    2. 真ん中にある実行ボタンを押します 
    3. 翻訳結果が表示されます
<br>
</p>
<h3>【仕様説明】</h3>
<p>この翻訳にはGPTAPIを使用しています。モデルは"text-davinci-003"。<br>
    GPTを使用した自然言語処理翻訳のため精度が比較的高く、適切な翻訳が生成されます。<br>
    とはいえ、あくまでAIという未だ不安定な技術のため、場合によっては不適切な翻訳が生成されることをあらかじめご了承ください。
</p>

    <div>
        {% if translated_text %}
        <script>
            var textarea = document.getElementsByName("translated_text")[0];
            textarea.value = "{{ translated_text }}";
    
            var textarea = document.getElementsByName("input_text")[0];
            textarea.value = "{{ input_text }}"
    
            function copyToClipboard(event) {
            event.preventDefault();
            var textarea = document.getElementById("translated_text");
            var text = textarea.value;
            
            navigator.clipboard.writeText(text).then(function() {
                // Optional: Change the button text to indicate successful copying
                var copyButton = document.getElementById("copyButton");
                alert("Copied!")
            }).catch(function(err) {
                console.error('Failed to copy text: ', err);
            });
    }
        </script>
        {% endif %}
    </div>
{% endblock %}